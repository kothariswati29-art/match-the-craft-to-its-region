<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Casa Carigar - Match the Craft</title>
<link href="https://fonts.googleapis.com/css2?family=Spectral:wght@500;600&family=Urbanist:wght@400;500;600&display=swap" rel="stylesheet">
<style>
:root {
  --bg-1: #f8f4e9;
  --bg-2: #efe6d6;
  --panel: #fcf8f0;
  --card: #ffffff;
  --ink: #14373f;
  --ink-soft: #5e797e;
  --accent: #8d391e;
  --accent-strong: #763019;
  --good-bg: #e8f5eb;
  --good-accent: #5ea278;
  --bad-bg: #fbeaea;
  --bad-accent: #cb6666;
  --shadow-soft: 0 14px 34px rgba(20, 55, 63, 0.1);
  --shadow-card: 0 6px 14px rgba(20, 55, 63, 0.07);
  --radius-xl: 20px;
  --radius-lg: 12px;
  --space-section: 32px;
  --space-element: 16px;
  --space-small: 8px;
}

* {
  box-sizing: border-box;
}

html,
body {
  margin: 0;
  min-height: 100%;
}

body {
  font-family: "Urbanist", sans-serif;
  color: var(--ink);
  line-height: 1.5;
  background: linear-gradient(165deg, var(--bg-1) 0%, var(--bg-2) 100%);
}

.app-shell {
  width: min(1100px, 92vw);
  margin: 0 auto;
  padding: 24px 0;
}

.screen {
  display: none;
  background: var(--panel);
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-soft);
  padding: var(--space-section);
}

.active {
  display: block;
}

.hidden {
  display: none !important;
}

.logo {
  display: block;
  margin: 0 auto 16px;
  width: 200px;
  height: auto;
  object-fit: contain;
}

h1,
h2,
h3,
p {
  margin: 0;
}

h1,
h2,
h3 {
  font-family: "Spectral", serif;
  font-weight: 600;
  line-height: 1.2;
}

.title {
  text-align: center;
  font-size: clamp(28px, 5vw, 48px);
  letter-spacing: 0.02em;
}

.hero-title {
  white-space: nowrap;
  text-align: center;
  width: 100%;
}

.text-soft {
  color: var(--ink-soft);
}

.btn-row {
  display: flex;
  justify-content: center;
  gap: var(--space-element);
}

.btn {
  border: 0;
  border-radius: var(--radius-lg);
  min-height: 44px;
  padding: 12px 18px;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: transform 140ms ease, background-color 140ms ease, color 140ms ease;
}

.btn:hover:not(:disabled) {
  transform: translateY(-1px);
}

.btn:disabled {
  opacity: 0.55;
  cursor: not-allowed;
}

.btn-primary {
  background: var(--accent);
  color: #fff;
}

.btn-primary:hover:not(:disabled) {
  background: var(--accent-strong);
}

.btn-secondary {
  background: rgba(20, 55, 63, 0.08);
  color: var(--ink);
}

.btn-secondary:hover:not(:disabled) {
  background: rgba(20, 55, 63, 0.14);
}

.btn-home {
  background: #1f4349;
  color: #f7f1e3;
}

.btn-home:hover:not(:disabled) {
  background: #19383d;
}

.input {
  width: 100%;
  border: 0;
  border-radius: 12px;
  background: #fff;
  padding: 14px 16px;
  font-size: 15px;
  box-shadow: inset 0 0 0 1px rgba(20, 55, 63, 0.14);
}

.input:focus {
  outline: none;
  box-shadow: inset 0 0 0 2px rgba(20, 55, 63, 0.28);
}

#home-screen {
  width: 100%;
  min-height: calc(100vh - 32px);
  margin: 0 auto;
  display: grid;
  place-content: center;
  text-align: center;
}

.hero-card {
  padding: 48px 40px;
}

.hero-card > * {
  margin-bottom: 20px;
}

.hero-card > *:last-child {
  margin-bottom: 0;
}

#game-screen,
#leaderboard-screen {
  width: 100%;
}

.game-topbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;
  margin-bottom: var(--space-section);
}

.score {
  font-size: 15px;
  font-weight: 600;
  color: var(--ink-soft);
}

.game-board {
  position: relative;
  background: #fffdf8;
  border-radius: 16px;
  box-shadow: var(--shadow-card);
  padding: var(--space-section);
}

.game-grid {
  display: grid;
  grid-template-columns: minmax(280px, 1fr) minmax(120px, 160px) minmax(280px, 1fr);
  gap: 64px;
  align-items: start;
}

.col-title {
  margin-bottom: var(--space-element);
  font-size: 18px;
  color: var(--ink-soft);
}

.card-list {
  display: flex;
  flex-direction: column;
  gap: var(--space-element);
}

.match-card {
  width: 100%;
  min-height: 50px;
  padding: 13px 14px;
  border: 0;
  border-radius: 12px;
  background: var(--card);
  box-shadow: var(--shadow-card);
  color: var(--ink);
  text-align: left;
  font-size: 14px;
  line-height: 1.3;
  cursor: pointer;
  transition: box-shadow 140ms ease, background-color 140ms ease;
}

.match-card:hover:not(.is-locked) {
  box-shadow: 0 10px 18px rgba(20, 55, 63, 0.11);
}

.match-card.is-selected {
  background: #fff2ec;
  box-shadow: inset 0 0 0 2px rgba(141, 57, 30, 0.32);
}

.match-card.is-locked {
  cursor: default;
  background: #f2ece2;
}

.line-zone {
  position: relative;
  min-height: 100%;
}

.line-layer {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
}

.mobile-helper {
  display: none;
  margin-top: var(--space-element);
  font-size: 13px;
  color: var(--ink-soft);
}

.submit-row {
  margin-top: var(--space-section);
  display: flex;
  justify-content: center;
}

.leaderboard-top {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;
  margin-bottom: var(--space-section);
}

.leaderboard-list {
  display: flex;
  flex-direction: column;
  gap: var(--space-element);
}

.leaderboard-item {
  background: #fff;
  border-radius: 12px;
  box-shadow: var(--shadow-card);
  padding: 14px;
  display: grid;
  grid-template-columns: 1fr auto auto;
  gap: 12px;
  align-items: center;
}

.results-panel {
  margin-top: var(--space-section);
  padding-top: var(--space-section);
}

.results-head {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;
  margin-bottom: var(--space-element);
}

.results-summary {
  margin: 0 0 var(--space-section);
  color: var(--ink-soft);
  font-weight: 600;
}

.results-grid {
  display: grid;
  grid-template-columns: minmax(280px, 1fr) minmax(120px, 160px) minmax(280px, 1fr);
  gap: 64px;
  align-items: start;
}

.result-card {
  width: 100%;
  min-height: 50px;
  padding: 13px 14px;
  border-radius: 12px;
  background: #fff;
  box-shadow: var(--shadow-card);
  font-size: 14px;
  line-height: 1.3;
}

.result-card.good {
  background: var(--good-bg);
  box-shadow: inset 0 0 0 1px var(--good-accent);
}

.result-card.bad {
  background: var(--bad-bg);
  box-shadow: inset 0 0 0 1px var(--bad-accent);
}

@media (max-width: 767px) {
  .app-shell {
    padding: 16px 0;
  }

  .screen {
    padding: 16px;
    border-radius: 16px;
  }

  .logo {
    width: 150px;
    margin-bottom: 16px;
  }

  #home-screen {
    min-height: calc(100vh - 16px);
  }

  .hero-card {
    padding: 32px 20px;
  }

  .hero-card > * {
    margin-bottom: 20px;
  }

  .hero-title {
    font-size: 24px;
  }

  .game-board {
    padding: 16px;
  }

  .game-grid {
    grid-template-columns: 1fr 1fr;
    gap: 24px;
  }

  .line-zone {
    display: none;
  }

  .mobile-helper {
    display: block;
  }

  .match-card {
    padding: 10px 11px;
    font-size: 13px;
  }

  .leaderboard-item {
    grid-template-columns: 1fr;
  }

  .results-grid {
    grid-template-columns: 1fr 1fr;
    gap: 16px;
  }

  .results-grid > div:nth-child(2) {
    display: none;
  }
}
</style>
</head>
<body>
  <div class="app-shell">
    <section id="home-screen" class="screen hero-card active">
      <img class="logo" src="./logo.png" alt="Casa Carigar logo" loading="eager" decoding="sync" />
      <h1 class="title hero-title">Match the Craft to Its Region</h1>
      <input id="player-name" class="input" type="text" maxlength="40" placeholder="Your Name" />
      <div class="btn-row">
        <button id="start-btn" class="btn btn-primary" type="button">Start Game</button>
        <button id="leaderboard-btn" class="btn btn-secondary" type="button">Leaderboard</button>
      </div>
    </section>

    <section id="game-screen" class="screen hidden">
      <div class="game-topbar">
        <div id="score-text" class="score">Matches: 0 / 10</div>
        <button id="home-from-game-btn" class="btn btn-home" type="button">Home</button>
      </div>

      <div class="game-board">
        <div class="game-grid">
          <div>
            <h3 class="col-title">Crafts</h3>
            <div id="craft-list" class="card-list"></div>
          </div>

          <div id="line-zone" class="line-zone">
            <svg id="line-layer" class="line-layer" aria-hidden="true"></svg>
          </div>

          <div id="region-column">
            <h3 id="region-title" class="col-title">Regions</h3>
            <div id="region-list" class="card-list"></div>
          </div>
        </div>
        <p id="mobile-helper" class="mobile-helper">Select a craft to reveal regions.</p>
      </div>

      <div class="submit-row">
        <button id="submit-btn" class="btn btn-primary" type="button" disabled>Submit</button>
      </div>
    </section>

    <section id="leaderboard-screen" class="screen hidden">
      <div class="leaderboard-top">
        <h2>Leaderboard</h2>
        <button id="home-from-leaderboard-btn" class="btn btn-home" type="button">Home</button>
      </div>

      <div id="leaderboard-list" class="leaderboard-list"></div>

      <div id="results-panel" class="results-panel hidden">
        <div class="results-head">
          <h3 id="results-title">Results</h3>
          <button id="back-to-leaderboard-btn" class="btn btn-secondary" type="button">Back to Leaderboard</button>
        </div>
        <p id="results-summary" class="results-summary"></p>

        <div class="results-grid">
          <div>
            <h3 class="col-title">Crafts</h3>
            <div id="results-craft-list" class="card-list"></div>
          </div>
          <div></div>
          <div>
            <h3 class="col-title">Regions</h3>
            <div id="results-region-list" class="card-list"></div>
          </div>
        </div>
      </div>
    </section>
  </div>

<script>
const CRAFTS = [
  "Brass work", "Wood carving", "Blue pottery", "Block printing",
  "Lacquered toys", "Handmade tiles", "Bidriware",
  "Dhokra metalwork", "Shisha embroidery", "Bone inlay"
];

const REGIONS = [
  "Moradabad", "Saharanpur", "Jaipur", "Sanganer",
  "Channapatna", "Athangudi", "Bidar",
  "Bastar", "Kutch", "Udaipur"
];

const CORRECT_MATCHES = {
  "Brass work": "Moradabad",
  "Wood carving": "Saharanpur",
  "Blue pottery": "Jaipur",
  "Block printing": "Sanganer",
  "Lacquered toys": "Channapatna",
  "Handmade tiles": "Athangudi",
  "Bidriware": "Bidar",
  "Dhokra metalwork": "Bastar",
  "Shisha embroidery": "Kutch",
  "Bone inlay": "Udaipur"
};

const dom = {
  screens: {
    home: document.getElementById("home-screen"),
    game: document.getElementById("game-screen"),
    leaderboard: document.getElementById("leaderboard-screen")
  },
  playerName: document.getElementById("player-name"),
  scoreText: document.getElementById("score-text"),
  craftList: document.getElementById("craft-list"),
  regionList: document.getElementById("region-list"),
  regionColumn: document.getElementById("region-column"),
  regionTitle: document.getElementById("region-title"),
  lineZone: document.getElementById("line-zone"),
  lineLayer: document.getElementById("line-layer"),
  mobileHelper: document.getElementById("mobile-helper"),
  submitBtn: document.getElementById("submit-btn"),
  leaderboardList: document.getElementById("leaderboard-list"),
  resultsPanel: document.getElementById("results-panel"),
  resultsTitle: document.getElementById("results-title"),
  resultsSummary: document.getElementById("results-summary"),
  resultsCraftList: document.getElementById("results-craft-list"),
  resultsRegionList: document.getElementById("results-region-list")
};

const state = {
  currentView: "home",
  currentPlayer: "",
  selectedCraft: null,
  matches: {},
  usedRegions: new Set(),
  shuffledRegions: [],
  craftEls: new Map(),
  regionEls: new Map(),
  resizeRAF: null
};

function isMobile() {
  return window.matchMedia("(max-width: 767px)").matches;
}

function hideAllScreens() {
  Object.values(dom.screens).forEach((screen) => {
    screen.classList.remove("active");
    screen.classList.add("hidden");
  });
}

function switchView(viewName) {
  hideAllScreens();
  dom.screens[viewName].classList.remove("hidden");
  dom.screens[viewName].classList.add("active");
  state.currentView = viewName;

  if (viewName !== "leaderboard") {
    hideResultsPanel();
  }
  if (viewName !== "game") {
    clearLines();
    state.selectedCraft = null;
  }
}

function shuffle(input) {
  const arr = [...input];
  for (let i = arr.length - 1; i > 0; i -= 1) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

function startGame() {
  const name = dom.playerName.value.trim();
  if (!name) {
    alert("Enter your name to start.");
    return;
  }

  state.currentPlayer = name;
  state.selectedCraft = null;
  state.matches = {};
  state.usedRegions = new Set();
  state.shuffledRegions = shuffle(REGIONS);
  state.craftEls.clear();
  state.regionEls.clear();

  renderGame();
  updateScore();
  updateMobileStep();
  switchView("game");
  requestAnimationFrame(drawConnections);
}

function renderGame() {
  dom.craftList.innerHTML = "";
  dom.regionList.innerHTML = "";
  clearLines();

  CRAFTS.forEach((craft) => {
    const card = document.createElement("button");
    card.className = "match-card";
    card.type = "button";
    card.textContent = craft;
    card.addEventListener("click", () => selectCraft(craft));
    dom.craftList.appendChild(card);
    state.craftEls.set(craft, card);
  });

  state.shuffledRegions.forEach((region) => {
    const card = document.createElement("button");
    card.className = "match-card";
    card.type = "button";
    card.textContent = region;
    card.addEventListener("click", () => selectRegion(region));
    dom.regionList.appendChild(card);
    state.regionEls.set(region, card);
  });
}

function selectCraft(craft) {
  if (state.matches[craft]) {
    return;
  }

  state.selectedCraft = state.selectedCraft === craft ? null : craft;
  state.craftEls.forEach((el, craftName) => {
    el.classList.toggle("is-selected", state.selectedCraft === craftName);
  });
  updateMobileStep();
}

function handleMatch(craft, region) {
  state.matches[craft] = region;
  state.usedRegions.add(region);
  state.selectedCraft = null;

  const craftEl = state.craftEls.get(craft);
  const regionEl = state.regionEls.get(region);
  if (craftEl) {
    craftEl.classList.remove("is-selected");
    craftEl.classList.add("is-locked");
  }
  if (regionEl) {
    regionEl.classList.add("is-locked");
  }

  updateScore();
  updateMobileStep();
  drawConnections();
}

function selectRegion(region) {
  if (!state.selectedCraft || state.usedRegions.has(region)) {
    return;
  }
  handleMatch(state.selectedCraft, region);
}

function updateScore() {
  const matchCount = Object.keys(state.matches).length;
  dom.scoreText.textContent = `Matches: ${matchCount} / ${CRAFTS.length}`;
  dom.submitBtn.disabled = matchCount !== CRAFTS.length;
}

function updateMobileStep() {
  dom.regionColumn.classList.remove("hidden");

  if (!isMobile()) {
    dom.mobileHelper.textContent = "";
    return;
  }

  dom.mobileHelper.textContent = state.selectedCraft
    ? `Select a region for ${state.selectedCraft}.`
    : "Select a craft, then select a region.";
}

function clearLines() {
  dom.lineLayer.innerHTML = "";
}

function drawConnections() {
  clearLines();
  if (state.currentView !== "game" || isMobile()) {
    return;
  }

  const zoneRect = dom.lineZone.getBoundingClientRect();
  const width = zoneRect.width;
  const height = zoneRect.height;
  dom.lineLayer.setAttribute("viewBox", `0 0 ${width} ${height}`);

  Object.entries(state.matches).forEach(([craft, region]) => {
    const craftRect = state.craftEls.get(craft)?.getBoundingClientRect();
    const regionRect = state.regionEls.get(region)?.getBoundingClientRect();
    if (!craftRect || !regionRect) {
      return;
    }

    const y1 = craftRect.top + (craftRect.height / 2) - zoneRect.top;
    const y2 = regionRect.top + (regionRect.height / 2) - zoneRect.top;
    const x1 = 10;
    const x2 = width - 10;
    const cx1 = width * 0.34;
    const cx2 = width * 0.66;

    const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
    path.setAttribute("d", `M ${x1.toFixed(2)} ${y1.toFixed(2)} C ${cx1.toFixed(2)} ${y1.toFixed(2)}, ${cx2.toFixed(2)} ${y2.toFixed(2)}, ${x2.toFixed(2)} ${y2.toFixed(2)}`);
    path.setAttribute("fill", "none");
    path.setAttribute("stroke", "#668287");
    path.setAttribute("stroke-width", "1.5");
    path.setAttribute("stroke-linecap", "round");
    path.setAttribute("opacity", "0.82");
    dom.lineLayer.appendChild(path);
  });
}

function calculateResults(matches) {
  const correctPairs = [];
  const incorrectPairs = [];

  CRAFTS.forEach((craft) => {
    const region = matches[craft];
    if (!region) {
      return;
    }
    if (region === CORRECT_MATCHES[craft]) {
      correctPairs.push({ craft, region });
    } else {
      incorrectPairs.push({ craft, region });
    }
  });

  return {
    score: correctPairs.length,
    correctPairs,
    incorrectPairs
  };
}

function submitGame() {
  const result = calculateResults(state.matches);
  saveLeaderboardEntry({
    name: state.currentPlayer,
    score: result.score,
    correctPairs: result.correctPairs,
    incorrectPairs: result.incorrectPairs
  });
  renderLeaderboard();
  switchView("leaderboard");
}

function saveLeaderboardEntry(entry) {
  const leaderboard = JSON.parse(localStorage.getItem("leaderboard") || "[]");
  leaderboard.push({
    ...entry,
    id: `${Date.now()}-${Math.random().toString(16).slice(2)}`,
    createdAt: Date.now()
  });

  leaderboard.sort((a, b) => {
    if (b.score !== a.score) {
      return b.score - a.score;
    }
    return a.createdAt - b.createdAt;
  });

  localStorage.setItem("leaderboard", JSON.stringify(leaderboard));
}

function renderLeaderboard() {
  const leaderboard = JSON.parse(localStorage.getItem("leaderboard") || "[]");
  dom.leaderboardList.innerHTML = "";

  if (!leaderboard.length) {
    const empty = document.createElement("div");
    empty.className = "leaderboard-item";
    empty.innerHTML = "<span class='text-soft'>No scores yet.</span>";
    dom.leaderboardList.appendChild(empty);
    return;
  }

  leaderboard.forEach((entry, index) => {
    const row = document.createElement("div");
    row.className = "leaderboard-item";

    const name = document.createElement("div");
    name.textContent = `${index + 1}. ${entry.name}`;

    const score = document.createElement("strong");
    score.textContent = `${entry.score}/${CRAFTS.length}`;

    const viewBtn = document.createElement("button");
    viewBtn.className = "btn btn-secondary";
    viewBtn.type = "button";
    viewBtn.textContent = "View Results";
    viewBtn.addEventListener("click", () => showResults(entry));

    row.appendChild(name);
    row.appendChild(score);
    row.appendChild(viewBtn);
    dom.leaderboardList.appendChild(row);
  });
}

function hideResultsPanel() {
  dom.resultsPanel.classList.add("hidden");
  dom.resultsCraftList.innerHTML = "";
  dom.resultsRegionList.innerHTML = "";
}

function showResults(entry) {
  dom.resultsTitle.textContent = `${entry.name}'s Results`;
  dom.resultsSummary.textContent = `You scored ${entry.score} / ${CRAFTS.length}`;
  dom.resultsCraftList.innerHTML = "";
  dom.resultsRegionList.innerHTML = "";

  const regionStatus = {};
  entry.correctPairs.forEach((pair) => {
    regionStatus[pair.region] = "good";
  });
  entry.incorrectPairs.forEach((pair) => {
    regionStatus[pair.region] = "bad";
  });

  CRAFTS.forEach((craft) => {
    const foundCorrect = entry.correctPairs.find((pair) => pair.craft === craft);
    const foundIncorrect = entry.incorrectPairs.find((pair) => pair.craft === craft);
    const status = foundCorrect ? "good" : (foundIncorrect ? "bad" : "");
    const region = foundCorrect?.region || foundIncorrect?.region || "-";

    const card = document.createElement("div");
    card.className = `result-card ${status}`.trim();
    card.textContent = `${craft} - ${region}`;
    dom.resultsCraftList.appendChild(card);
  });

  REGIONS.forEach((region) => {
    const status = regionStatus[region] || "";
    const card = document.createElement("div");
    card.className = `result-card ${status}`.trim();
    card.textContent = region;
    dom.resultsRegionList.appendChild(card);
  });

  dom.resultsPanel.classList.remove("hidden");
}

function goHome() {
  switchView("home");
}

function bindEvents() {
  document.getElementById("start-btn").addEventListener("click", startGame);
  document.getElementById("leaderboard-btn").addEventListener("click", () => {
    renderLeaderboard();
    switchView("leaderboard");
  });
  document.getElementById("home-from-game-btn").addEventListener("click", goHome);
  document.getElementById("home-from-leaderboard-btn").addEventListener("click", goHome);
  document.getElementById("submit-btn").addEventListener("click", submitGame);
  document.getElementById("back-to-leaderboard-btn").addEventListener("click", hideResultsPanel);

  window.addEventListener("resize", () => {
    updateMobileStep();
    if (state.resizeRAF) {
      cancelAnimationFrame(state.resizeRAF);
    }
    state.resizeRAF = requestAnimationFrame(drawConnections);
  });
}

bindEvents();
</script>
</body>
</html>
