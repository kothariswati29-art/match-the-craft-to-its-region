<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Casa Carigar - Match the Craft</title>
<link href="https://fonts.googleapis.com/css2?family=Spectral:wght@500;600&family=Urbanist:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
:root {
  --bg-cream: #f3efe4;
  --panel-cream: #f9f6ee;
  --ink: #103239;
  --ink-soft: #456066;
  --accent: #8d391e;
  --accent-soft: #ad6249;
  --line: #cabfa8;
  --matched: #e7e2d5;
  --shadow: 0 10px 24px rgba(16, 50, 57, 0.08);
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  font-family: "Urbanist", sans-serif;
  color: var(--ink);
  background: radial-gradient(circle at 0% 0%, #f8f5ec, #f3efe4 46%, #efe9dc 100%);
}

.app-shell {
  max-width: 1060px;
  margin: 0 auto;
  padding: 20px 18px 28px;
}

.screen-logo {
  display: block;
  width: auto;
  height: auto;
  max-height: 60px;
  object-fit: contain;
  margin-bottom: 16px;
}

.logo-centered {
  margin-left: auto;
  margin-right: auto;
}

.screen {
  background: var(--panel-cream);
  border: 1px solid #ddd1ba;
  border-radius: 16px;
  box-shadow: var(--shadow);
  padding: 24px;
  animation: rise 260ms ease;
}

.hidden {
  display: none;
}

@keyframes rise {
  from {
    opacity: 0;
    transform: translateY(7px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

h1,
h2,
h3 {
  margin: 0;
  font-family: "Spectral", serif;
  font-weight: 600;
}

.subtext {
  margin: 10px 0 0;
  color: var(--ink-soft);
  font-size: 14px;
  text-align: center;
}

.home-content {
  max-width: 430px;
  margin: 0 auto;
  text-align: center;
}

.input {
  width: 100%;
  margin-top: 20px;
  border: 1px solid #cdbfa6;
  border-radius: 10px;
  padding: 12px 13px;
  font-size: 15px;
  background: #fffdf8;
  color: var(--ink);
  transition: border-color 170ms ease, box-shadow 170ms ease;
}

.input:focus {
  outline: none;
  border-color: var(--ink-soft);
  box-shadow: 0 0 0 3px rgba(69, 96, 102, 0.15);
}

.row {
  display: flex;
  gap: 10px;
  justify-content: center;
  margin-top: 14px;
  flex-wrap: wrap;
}

.btn {
  border: 1px solid transparent;
  border-radius: 10px;
  padding: 10px 16px;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: transform 170ms ease, background-color 170ms ease, color 170ms ease, border-color 170ms ease;
}

.btn:hover:not(:disabled) {
  transform: translateY(-1px);
}

.btn:disabled {
  opacity: 0.55;
  cursor: not-allowed;
}

.btn-primary {
  background: var(--accent);
  color: #fff;
}

.btn-primary:hover:not(:disabled) {
  background: #7b3019;
}

.btn-secondary {
  background: transparent;
  border-color: #b5a486;
  color: var(--ink);
}

.btn-secondary:hover:not(:disabled) {
  background: #f1eadb;
}

.game-topbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;
  margin-bottom: 14px;
}

.score {
  font-size: 15px;
  color: var(--ink-soft);
}

.home-btn {
  background: #29494f;
  color: #f5f0e2;
  border: 1px solid #213d43;
}

.home-btn:hover {
  background: #1f3d42;
}

.board {
  position: relative;
  border: 1px solid #ded2bc;
  border-radius: 12px;
  padding: 16px 10px;
  max-width: 900px;
  margin: 0 auto;
  overflow: hidden;
  background: linear-gradient(180deg, #fcfaf4 0%, #f7f2e7 100%);
}

.board-grid {
  display: grid;
  grid-template-columns: 42% 16% 42%;
  width: 100%;
  max-width: 900px;
  margin: 0 auto;
  align-items: stretch;
  column-gap: 2px;
}

.col {
  display: flex;
  flex-direction: column;
  gap: 10px;
  min-width: 0;
}

.col-title {
  font-size: 18px;
  color: var(--ink-soft);
  margin-bottom: 3px;
}

.center-lane {
  min-height: 100%;
  border-left: 1px dashed #dccfb6;
  border-right: 1px dashed #dccfb6;
  margin: 0 2px;
  opacity: 0.65;
}

.card {
  width: 100%;
  min-height: 42px;
  border: 1px solid #cdbfa7;
  border-radius: 10px;
  background: #fffdf8;
  color: var(--ink);
  padding: 10px 12px;
  font-size: 14px;
  line-height: 1.2;
  text-align: left;
  cursor: pointer;
  transition: border-color 170ms ease, background-color 170ms ease, box-shadow 170ms ease;
}

.card:hover:not(.is-locked) {
  border-color: #ab9b7d;
  box-shadow: 0 5px 14px rgba(16, 50, 57, 0.09);
}

.card.is-selected {
  border-color: var(--accent-soft);
  box-shadow: 0 0 0 2px rgba(141, 57, 30, 0.15);
  background: #fff6f0;
}

.card.is-locked {
  background: var(--matched);
  border-color: #b8aa92;
  cursor: default;
}

.connection-layer {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  overflow: hidden;
}

.actions {
  text-align: center;
  margin-top: 16px;
}

.result-title {
  text-align: center;
}

.result-score {
  text-align: center;
  margin-top: 10px;
  color: var(--ink-soft);
}

.list {
  margin-top: 14px;
  border: 1px solid #d9ccb5;
  border-radius: 10px;
  overflow: hidden;
  background: #fffdf8;
}

.leaderboard-entry {
  display: flex;
  justify-content: space-between;
  gap: 10px;
  padding: 11px 13px;
  border-bottom: 1px solid #ece2d0;
  font-size: 14px;
}

.leaderboard-entry:last-child {
  border-bottom: 0;
}

.muted {
  color: var(--ink-soft);
}

@media (max-width: 820px) {
  .screen {
    padding: 20px 14px;
  }

  .screen-logo {
    max-height: 40px;
  }

  .board {
    padding: 14px 8px;
  }

  .col-title {
    font-size: 16px;
  }

  .card {
    font-size: 13px;
    padding: 9px 10px;
  }
}
</style>
</head>
<body>
  <div class="app-shell">
    <main>
      <section id="homeScreen" class="screen">
        <div class="home-content">
          <img class="screen-logo logo-centered" src="./logo.png" alt="Casa Carigar logo" loading="eager" decoding="sync" />
          <h1>Match the Craft to Its Region</h1>
          <p class="subtext">Pair each Indian craft with the correct region.</p>
          <input id="playerName" class="input" type="text" maxlength="40" placeholder="Your Name" />
          <div class="row">
            <button id="startBtn" class="btn btn-primary">Start Game</button>
            <button id="openLeaderboardBtn" class="btn btn-secondary">Leaderboard</button>
          </div>
        </div>
      </section>

      <section id="gameScreen" class="screen hidden">
        <img class="screen-logo logo-centered" src="./logo.png" alt="Casa Carigar logo" loading="eager" decoding="sync" />
        <div class="game-topbar">
          <div id="scoreText" class="score">Matches: 0 / 10</div>
          <button id="homeFromGameBtn" class="btn home-btn">Home</button>
        </div>

        <div id="board" class="board">
          <svg id="lineLayer" class="connection-layer" aria-hidden="true"></svg>

          <div class="board-grid">
            <div>
              <h3 class="col-title">Crafts</h3>
              <div id="craftCol" class="col"></div>
            </div>

            <div class="center-lane" aria-hidden="true"></div>

            <div>
              <h3 class="col-title">Regions</h3>
              <div id="regionCol" class="col"></div>
            </div>
          </div>
        </div>

        <div class="actions">
          <button id="submitBtn" class="btn btn-primary" disabled>Submit</button>
        </div>
      </section>

      <section id="resultScreen" class="screen hidden">
        <h2 class="result-title">Result</h2>
        <p id="resultText" class="result-score"></p>
        <div class="row">
          <button id="homeFromResultBtn" class="btn btn-secondary">Home</button>
          <button id="leaderboardFromResultBtn" class="btn btn-primary">Leaderboard</button>
        </div>
      </section>

      <section id="leaderboardScreen" class="screen hidden">
        <img class="screen-logo logo-centered" src="./logo.png" alt="Casa Carigar logo" loading="eager" decoding="sync" />
        <div class="row" style="justify-content: space-between; margin-top: 0;">
          <h2>Leaderboard</h2>
          <button id="backFromLeaderboardBtn" class="btn btn-secondary">Back</button>
        </div>
        <div id="leaderboardList" class="list"></div>
      </section>
    </main>
  </div>

<script>
const CRAFTS = [
  "Brass work", "Wood carving", "Blue pottery", "Block printing",
  "Lacquered toys", "Handmade tiles", "Bidriware",
  "Dhokra metalwork", "Shisha embroidery", "Bone inlay"
];

const REGIONS = [
  "Moradabad", "Saharanpur", "Jaipur", "Sanganer",
  "Channapatna", "Athangudi", "Bidar",
  "Bastar", "Kutch", "Udaipur"
];

const CORRECT_MATCHES = {
  "Brass work": "Moradabad",
  "Wood carving": "Saharanpur",
  "Blue pottery": "Jaipur",
  "Block printing": "Sanganer",
  "Lacquered toys": "Channapatna",
  "Handmade tiles": "Athangudi",
  "Bidriware": "Bidar",
  "Dhokra metalwork": "Bastar",
  "Shisha embroidery": "Kutch",
  "Bone inlay": "Udaipur"
};

const SCREENS = {
  home: document.getElementById("homeScreen"),
  game: document.getElementById("gameScreen"),
  result: document.getElementById("resultScreen"),
  leaderboard: document.getElementById("leaderboardScreen")
};

const dom = {
  playerName: document.getElementById("playerName"),
  scoreText: document.getElementById("scoreText"),
  craftCol: document.getElementById("craftCol"),
  regionCol: document.getElementById("regionCol"),
  submitBtn: document.getElementById("submitBtn"),
  resultText: document.getElementById("resultText"),
  leaderboardList: document.getElementById("leaderboardList"),
  board: document.getElementById("board"),
  lineLayer: document.getElementById("lineLayer")
};

const state = {
  currentPlayer: "",
  selectedCraft: null,
  matches: {},
  usedRegions: new Set(),
  shuffledRegions: [],
  craftEls: new Map(),
  regionEls: new Map(),
  resizeRAF: null
};

function shuffle(array) {
  for (let i = array.length - 1; i > 0; i -= 1) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

function showScreen(name) {
  Object.values(SCREENS).forEach((screen) => screen.classList.add("hidden"));
  SCREENS[name].classList.remove("hidden");
}

function resetRoundState() {
  state.selectedCraft = null;
  state.matches = {};
  state.usedRegions = new Set();
  state.craftEls.clear();
  state.regionEls.clear();
  clearLines();
}

function startGame() {
  const name = dom.playerName.value.trim();
  if (!name) {
    alert("Enter your name to start.");
    return;
  }

  state.currentPlayer = name;
  state.shuffledRegions = shuffle([...REGIONS]);
  resetRoundState();

  renderCards();
  updateScoreUI();
  dom.submitBtn.disabled = true;
  showScreen("game");

  // Draw once after layout settles.
  requestAnimationFrame(drawConnections);
}

function goHome() {
  resetRoundState();
  showScreen("home");
}

function openLeaderboard() {
  resetRoundState();
  renderLeaderboard();
  showScreen("leaderboard");
}

function renderCards() {
  dom.craftCol.innerHTML = "";
  dom.regionCol.innerHTML = "";

  CRAFTS.forEach((craft) => {
    const btn = document.createElement("button");
    btn.className = "card";
    btn.type = "button";
    btn.textContent = craft;
    btn.addEventListener("click", () => selectCraft(craft));
    dom.craftCol.appendChild(btn);
    state.craftEls.set(craft, btn);
  });

  state.shuffledRegions.forEach((region) => {
    const btn = document.createElement("button");
    btn.className = "card";
    btn.type = "button";
    btn.textContent = region;
    btn.addEventListener("click", () => selectRegion(region));
    dom.regionCol.appendChild(btn);
    state.regionEls.set(region, btn);
  });
}

function selectCraft(craft) {
  if (state.matches[craft]) {
    return;
  }

  if (state.selectedCraft === craft) {
    state.selectedCraft = null;
  } else {
    state.selectedCraft = craft;
  }

  state.craftEls.forEach((el, craftName) => {
    const active = state.selectedCraft === craftName;
    el.classList.toggle("is-selected", active);
  });
}

function selectRegion(region) {
  if (!state.selectedCraft || state.usedRegions.has(region)) {
    return;
  }

  const craft = state.selectedCraft;
  state.matches[craft] = region;
  state.usedRegions.add(region);
  state.selectedCraft = null;

  const craftEl = state.craftEls.get(craft);
  const regionEl = state.regionEls.get(region);

  if (craftEl) {
    craftEl.classList.remove("is-selected");
    craftEl.classList.add("is-locked");
  }

  if (regionEl) {
    regionEl.classList.add("is-locked");
  }

  updateScoreUI();
  drawConnections();
}

function updateScoreUI() {
  const count = Object.keys(state.matches).length;
  dom.scoreText.textContent = `Matches: ${count} / ${CRAFTS.length}`;
  dom.submitBtn.disabled = count !== CRAFTS.length;
}

function clearLines() {
  dom.lineLayer.innerHTML = "";
}

function drawConnections() {
  clearLines();

  const boardRect = dom.board.getBoundingClientRect();
  const stroke = getComputedStyle(document.documentElement).getPropertyValue("--ink-soft").trim();

  Object.entries(state.matches).forEach(([craft, region]) => {
    const craftEl = state.craftEls.get(craft);
    const regionEl = state.regionEls.get(region);

    if (!craftEl || !regionEl) {
      return;
    }

    const cRect = craftEl.getBoundingClientRect();
    const rRect = regionEl.getBoundingClientRect();

    const x1 = cRect.right - boardRect.left;
    const y1 = cRect.top + (cRect.height / 2) - boardRect.top;
    const x2 = rRect.left - boardRect.left;
    const y2 = rRect.top + (rRect.height / 2) - boardRect.top;

    const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
    line.setAttribute("x1", x1.toFixed(2));
    line.setAttribute("y1", y1.toFixed(2));
    line.setAttribute("x2", x2.toFixed(2));
    line.setAttribute("y2", y2.toFixed(2));
    line.setAttribute("stroke", stroke);
    line.setAttribute("stroke-width", "1.5");
    line.setAttribute("stroke-linecap", "round");
    line.setAttribute("opacity", "0.7");

    dom.lineLayer.appendChild(line);
  });
}

function submitGame() {
  let score = 0;

  Object.entries(CORRECT_MATCHES).forEach(([craft, region]) => {
    if (state.matches[craft] === region) {
      score += 1;
    }
  });

  saveScore(state.currentPlayer, score);
  dom.resultText.textContent = `${state.currentPlayer} scored ${score}/${CRAFTS.length}`;
  showScreen("result");
}

function saveScore(name, score) {
  const leaderboard = JSON.parse(localStorage.getItem("leaderboard") || "[]");
  leaderboard.push({ name, score, createdAt: Date.now() });
  leaderboard.sort((a, b) => {
    if (b.score !== a.score) {
      return b.score - a.score;
    }
    return a.createdAt - b.createdAt;
  });
  localStorage.setItem("leaderboard", JSON.stringify(leaderboard));
}

function renderLeaderboard() {
  const leaderboard = JSON.parse(localStorage.getItem("leaderboard") || "[]");

  if (!leaderboard.length) {
    dom.leaderboardList.innerHTML = '<div class="leaderboard-entry muted">No scores yet. Play a round to start the board.</div>';
    return;
  }

  dom.leaderboardList.innerHTML = "";
  leaderboard.forEach((entry, index) => {
    const row = document.createElement("div");
    row.className = "leaderboard-entry";
    row.innerHTML = `<span>${index + 1}. ${entry.name}</span><strong>${entry.score}/${CRAFTS.length}</strong>`;
    dom.leaderboardList.appendChild(row);
  });
}

function bindEvents() {
  document.getElementById("startBtn").addEventListener("click", startGame);
  document.getElementById("openLeaderboardBtn").addEventListener("click", openLeaderboard);
  document.getElementById("homeFromGameBtn").addEventListener("click", goHome);
  document.getElementById("homeFromResultBtn").addEventListener("click", goHome);
  document.getElementById("leaderboardFromResultBtn").addEventListener("click", openLeaderboard);
  document.getElementById("backFromLeaderboardBtn").addEventListener("click", goHome);
  dom.submitBtn.addEventListener("click", submitGame);

  window.addEventListener("resize", () => {
    if (SCREENS.game.classList.contains("hidden")) {
      return;
    }

    if (state.resizeRAF) {
      cancelAnimationFrame(state.resizeRAF);
    }

    state.resizeRAF = requestAnimationFrame(drawConnections);
  });
}

bindEvents();
showScreen("home");
</script>
</body>
</html>

